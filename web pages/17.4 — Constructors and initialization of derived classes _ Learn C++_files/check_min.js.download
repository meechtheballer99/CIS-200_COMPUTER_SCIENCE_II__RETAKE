jQuery(document).ready(function($){var clientIP=cfmonitor.client_ip;var maxclickcount=cfmonitor.max_clicks;var clicks;var is_blocked_ajax;var is_blocked=cfmonitor.is_blocked;var nonce=cfmonitor.nonce;var ajaxurl=cfmonitor.ajaxurl;var currentURL=cfmonitor.currentURL;var debug=cfmonitor.debug;var customclass=(cfmonitor.customclass!=null&&cfmonitor.customclass!='')?cfmonitor.customclass:'cfmonitor';var customClassArr=(cfmonitor.customclass!=null&&cfmonitor.customclass!='')?Array('.'+cfmonitor.customclass,'.adsbygoogle'):Array(' ','.adsbygoogle');var adsenseClass='adsbygoogle';var disablead=cfmonitor.disablead;var jq=jQuery;jq.cfmonitor={cfmonitor_options:{maxClicks:2,countDown:5,defaultElements:customClassArr,dataMethod:'GET',checkDataUrl:false,clickDataUrl:false,blockOnError:true,blockTitle:'Critical Error',thanksTitle:false,thanksMsg:false,thanksTimer:3},elements:[],iframes:[]};var cfmonitor_options=jq.extend(jq.cfmonitor.cfmonitor_options,cfmonitor_options);var isOverIFrame=false;var object=this;window.onpageshow=function(event){if(event.persisted){window.location.reload()}};updateElements();countajaxclicks();findIframes();jq("."+customclass).click(function(event){cfm_debug('initial click event');jq(document).ajaxStop(jQuery.unblockUI);jQuery.blockUI();ajax_post();});jq("."+adsenseClass).click(function(event){cfm_debug('initial click event');jq(document).ajaxStop(jQuery.unblockUI);jQuery.blockUI();ajax_post();});function saveElements(elements){elements=jq(elements).get();if(elements.length>1){jq.each(elements,function(i,val){jq.cfmonitor.elements.push(val);cfm_debug('push multi elements:'+elements);});}
else{jq.cfmonitor.elements.push(elements);cfm_debug('push single elements:'+elements);}
cfm_debug('global elements:'+elements);}
function updateElements(){jq.cfmonitor.elements=[];if(cfmonitor_options.defaultElements.length>0){cfm_debug('default Elem found: '+cfmonitor_options.defaultElements);saveElements(cfmonitor_options.defaultElements);}}
function cfm_debug(string){if(debug==='true'){console.log(string);}}
function cfm_remove_ads(){if(jq("ins.adsbygoogle").length){jq("ins.adsbygoogle").hide();}
if(jq('.'+customclass).length){jq('.'+customclass).remove();}}
function cfmonitorProcess(event)
{cfm_debug("clicks:"+clicks);if(is_blocked_ajax==1||is_blocked==='1')
{cfm_debug('Its blocked!');cfm_remove_ads();}}
function ajax_post()
{var postData={count:clicks,clickurl:currentURL}
jq.ajax({type:"post",dataType:"json",url:ajaxurl+"?action=ajax-updateclicks&nonce="+nonce,data:postData,success:function(response){clicks=response.clicks;is_blocked_ajax=response.blocked
cfmonitorProcess();if(response)
{cfm_debug('ajax_post response.blocked: '+response.blocked);return response;}
else
{cfm_debug('response 0');return 0;}}});}
function checkit()
{if(is_blocked==='1'||is_blocked_ajax==1||disablead==='true')
{cfm_remove_ads();}}
function countajaxclicks()
{jq.ajax({type:"POST",dataType:"json",cache:false,url:ajaxurl+"?action=ajax-checkclicks&nonce="+nonce,success:function(response){is_blocked_ajax=response.blocked;clicks=response.clicks;checkit();cfm_debug('step 5: countajaxclicks() response.clicks: '+response.clicks);return response.clicks;}});}
function saveIframes(iframes){iframes=jq(iframes).get();if(iframes.length>1){cfm_debug('push multi iframes into array'+iframes);jq.each(iframes,function(i,val){jq.cfmonitor.iframes.push(val);cfm_debug('multi iframe:'+val);});}
else{cfm_debug('push single iframe into array'+iframes);jq.cfmonitor.iframes.push(iframes);}}
function findIframes(){jq.each(jq.cfmonitor.elements,function(index,element){console.log(element);cfm_debug('iframe found: '+jq(element).find('iframe').length);if(jq(element).find('iframe').length){cfm_debug("iframe within custom class found: "+jq(element).find('iframe'));var frames=jq(element).find('iframe');cfm_debug('frame found: '+frames);frames=frames.get();saveIframes(frames);}});iframeAction(jq.cfmonitor.iframes);}
function iframeAction(){jq.each(jq.cfmonitor.iframes,function(index,element){frameID=jq(element).attr('id')||false;frameID_customClass=document.getElementsByClassName(customclass)||false;if(frameID){initiateIframe(frameID);cfm_debug('iframeAction1 iframe id=: '+frameID);}
if(frameID_customClass){initiateIframe(frameID_customClass);cfm_debug('iframeAction2 iframe id=: '+frameID_customClass);}});}
function initiateIframe(elementID){var googleClass=document.getElementById(elementID);var customClass=document.getElementsByClassName(customclass);for(var i=0,len=customClass.length;i<len;i++)
{customClass[i].onmouseover=processMouseOver;customClass[i].onmouseout=processMouseOut;cfm_debug("iframe customclass: "+customClass[i]+'found');}
if(googleClass){googleClass.onmouseover=processMouseOver;googleClass.onmouseout=processMouseOut;cfm_debug("iframe googleclass"+elementID+'found');}
if(typeof window.attachEvent!=='undefined'){top.attachEvent('onblur',processIFrameClick);cfm_debug("IE legacy: attach onblur processIFrameClick");}
else if(typeof window.addEventListener!=='undefined'){top.addEventListener('blur',processIFrameClick,false);cfm_debug("Other Browser new: attach blur processIFrameClick");}}
function processMouseOut(){cfm_debug("mouse out");isOverIFrame=false;top.focus();}
function processMouseOver(){cfm_debug("mouse over");isOverIFrame=true;}
function processIFrameClick(){if(isOverIFrame){cfm_debug("mouse frame click");ajax_post();top.focus();}}});/*!
* jQuery blockUI plugin
* Version 2.65.0-2013.09.02
* Requires jQuery v1.7 or later
*
* Examples at: http://malsup.com/jquery/block/
* Copyright (c) 2007-2013 M. Alsup
* Dual licensed under the MIT and GPL licenses:
* http://www.opensource.org/licenses/mit-license.php
* http://www.gnu.org/licenses/gpl.html
*
* Thanks to Amir-Hossein Sobhi for some excellent contributions!
*/;(function(){"use strict";function setup(jQuery){jQuery.fn._fadeIn=jQuery.fn.fadeIn;var noOp=jQuery.noop||function(){};var msie=/MSIE/.test(navigator.userAgent);var ie6=/MSIE 6.0/.test(navigator.userAgent)&&!/MSIE 8.0/.test(navigator.userAgent);var mode=document.documentMode||0;var setExpr=jQuery.isFunction(document.createElement('div').style.setExpression);jQuery.blockUI=function(opts){install(window,opts);};jQuery.unblockUI=function(opts){remove(window,opts);};jQuery.growlUI=function(title,message,timeout,onClose){var jQuerym=jQuery('<div class="growlUI"></div>');if(title)
jQuerym.append('<h1>'+title+'</h1>');if(message)
jQuerym.append('<h2>'+message+'</h2>');if(timeout===undefined)
timeout=3000;var callBlock=function(opts){opts=opts||{};jQuery.blockUI({message:jQuerym,fadeIn:typeof opts.fadeIn!=='undefined'?opts.fadeIn:700,fadeOut:typeof opts.fadeOut!=='undefined'?opts.fadeOut:1000,timeout:typeof opts.timeout!=='undefined'?opts.timeout:timeout,centerY:false,showOverlay:false,onUnblock:onClose,css:jQuery.blockUI.defaults.growlCSS});};callBlock();var nonmousedOpacity=jQuerym.css('opacity');jQuerym.mouseover(function(){callBlock({fadeIn:0,timeout:30000});var displayBlock=jQuery('.blockMsg');displayBlock.stop();displayBlock.fadeTo(300,1);}).mouseout(function(){jQuery('.blockMsg').fadeOut(1000);});};jQuery.fn.block=function(opts){if(this[0]===window){jQuery.blockUI(opts);return this;}
var fullOpts=jQuery.extend({},jQuery.blockUI.defaults,opts||{});this.each(function(){var jQueryel=jQuery(this);if(fullOpts.ignoreIfBlocked&&jQueryel.data('blockUI.isBlocked'))
return;jQueryel.unblock({fadeOut:0});});return this.each(function(){if(jQuery.css(this,'position')=='static'){this.style.position='relative';jQuery(this).data('blockUI.static',true);}
this.style.zoom=1;install(this,opts);});};jQuery.fn.unblock=function(opts){if(this[0]===window){jQuery.unblockUI(opts);return this;}
return this.each(function(){remove(this,opts);});};jQuery.blockUI.version=2.65;jQuery.blockUI.defaults={message:null,title:null,draggable:true,theme:false,css:{padding:0,margin:0,width:'30%',top:'40%',left:'35%',textAlign:'center',color:'#000',border:'3px solid #aaa',backgroundColor:'#fff',cursor:'wait'},themedCSS:{width:'30%',top:'40%',left:'35%'},overlayCSS:{backgroundColor:'#000',opacity:0.6,cursor:'wait'},cursorReset:'default',growlCSS:{width:'350px',top:'10px',left:'',right:'10px',border:'none',padding:'5px',opacity:0.6,cursor:'default',color:'#fff',backgroundColor:'#000','-webkit-border-radius':'10px','-moz-border-radius':'10px','border-radius':'10px'},iframeSrc:/^https/i.test(window.location.href||'')?'javascript:false':'about:blank',forceIframe:false,baseZ:1000,centerX:true,centerY:true,allowBodyStretch:true,bindEvents:true,constrainTabKey:true,fadeIn:200,fadeOut:400,timeout:0,showOverlay:true,focusInput:true,focusableElements:':input:enabled:visible',onBlock:null,onUnblock:null,onOverlayClick:null,quirksmodeOffsetHack:4,blockMsgClass:'blockMsg',ignoreIfBlocked:false};var pageBlock=null;var pageBlockEls=[];function install(el,opts){var css,themedCSS;var full=(el==window);var msg=(opts&&opts.message!==undefined?opts.message:undefined);opts=jQuery.extend({},jQuery.blockUI.defaults,opts||{});if(opts.ignoreIfBlocked&&jQuery(el).data('blockUI.isBlocked'))
return;opts.overlayCSS=jQuery.extend({},jQuery.blockUI.defaults.overlayCSS,opts.overlayCSS||{});css=jQuery.extend({},jQuery.blockUI.defaults.css,opts.css||{});if(opts.onOverlayClick)
opts.overlayCSS.cursor='pointer';themedCSS=jQuery.extend({},jQuery.blockUI.defaults.themedCSS,opts.themedCSS||{});msg=msg===undefined?opts.message:msg;if(full&&pageBlock)
remove(window,{fadeOut:0});if(msg&&typeof msg!='string'&&(msg.parentNode||msg.jquery)){var node=msg.jquery?msg[0]:msg;var data={};jQuery(el).data('blockUI.history',data);data.el=node;data.parent=node.parentNode;data.display=node.style.display;data.position=node.style.position;if(data.parent)
data.parent.removeChild(node);}
jQuery(el).data('blockUI.onUnblock',opts.onUnblock);var z=opts.baseZ;var lyr1,lyr2,lyr3,s;if(msie||opts.forceIframe)
lyr1=jQuery('<iframe class="blockUI" style="z-index:'+(z++)+';display:none;border:none;margin:0;padding:0;position:absolute;width:100%;height:100%;top:0;left:0" src="'+opts.iframeSrc+'"></iframe>');else
lyr1=jQuery('<div class="blockUI" style="display:none"></div>');if(opts.theme)
lyr2=jQuery('<div class="blockUI blockOverlay ui-widget-overlay" style="z-index:'+(z++)+';display:none"></div>');else
lyr2=jQuery('<div class="blockUI blockOverlay" style="z-index:'+(z++)+';display:none;border:none;margin:0;padding:0;width:100%;height:100%;top:0;left:0"></div>');if(opts.theme&&full){s='<div class="blockUI '+opts.blockMsgClass+' blockPage ui-dialog ui-widget ui-corner-all" style="z-index:'+(z+10)+';display:none;position:fixed">';if(opts.title){s+='<div class="ui-widget-header ui-dialog-titlebar ui-corner-all blockTitle">'+(opts.title||'&nbsp;')+'</div>';}
s+='<div class="ui-widget-content ui-dialog-content"></div>';s+='</div>';}
else if(opts.theme){s='<div class="blockUI '+opts.blockMsgClass+' blockElement ui-dialog ui-widget ui-corner-all" style="z-index:'+(z+10)+';display:none;position:absolute">';if(opts.title){s+='<div class="ui-widget-header ui-dialog-titlebar ui-corner-all blockTitle">'+(opts.title||'&nbsp;')+'</div>';}
s+='<div class="ui-widget-content ui-dialog-content"></div>';s+='</div>';}
else if(full){s='<div class="blockUI '+opts.blockMsgClass+' blockPage" style="z-index:'+(z+10)+';display:none;position:fixed"></div>';}
else{s='<div class="blockUI '+opts.blockMsgClass+' blockElement" style="z-index:'+(z+10)+';display:none;position:absolute"></div>';}
lyr3=jQuery(s);if(msg){if(opts.theme){lyr3.css(themedCSS);lyr3.addClass('ui-widget-content');}
else
lyr3.css(css);}
if(!opts.theme)
lyr2.css(opts.overlayCSS);lyr2.css('position',full?'fixed':'absolute');if(msie||opts.forceIframe)
lyr1.css('opacity',0.0);var layers=[lyr1,lyr2,lyr3],jQuerypar=full?jQuery('body'):jQuery(el);jQuery.each(layers,function(){this.appendTo(jQuerypar);});if(opts.theme&&opts.draggable&&jQuery.fn.draggable){lyr3.draggable({handle:'.ui-dialog-titlebar',cancel:'li'});}
var expr=setExpr&&(!jQuery.support.boxModel||jQuery('object,embed',full?null:el).length>0);if(ie6||expr){if(full&&opts.allowBodyStretch&&jQuery.support.boxModel)
jQuery('html,body').css('height','100%');if((ie6||!jQuery.support.boxModel)&&!full){var t=sz(el,'borderTopWidth'),l=sz(el,'borderLeftWidth');var fixT=t?'(0 - '+t+')':0;var fixL=l?'(0 - '+l+')':0;}
jQuery.each(layers,function(i,o){var s=o[0].style;s.position='absolute';if(i<2){if(full)
s.setExpression('height','Math.max(document.body.scrollHeight, document.body.offsetHeight) - (jQuery.support.boxModel?0:'+opts.quirksmodeOffsetHack+') + "px"');else
s.setExpression('height','this.parentNode.offsetHeight + "px"');if(full)
s.setExpression('width','jQuery.support.boxModel && document.documentElement.clientWidth || document.body.clientWidth + "px"');else
s.setExpression('width','this.parentNode.offsetWidth + "px"');if(fixL)
s.setExpression('left',fixL);if(fixT)
s.setExpression('top',fixT);}
else if(opts.centerY){if(full)
s.setExpression('top','(document.documentElement.clientHeight || document.body.clientHeight) / 2 - (this.offsetHeight / 2) + (blah = document.documentElement.scrollTop ? document.documentElement.scrollTop : document.body.scrollTop) + "px"');s.marginTop=0;}
else if(!opts.centerY&&full){var top=(opts.css&&opts.css.top)?parseInt(opts.css.top,10):0;var expression='((document.documentElement.scrollTop ? document.documentElement.scrollTop : document.body.scrollTop) + '+top+') + "px"';s.setExpression('top',expression);}});}
if(msg){if(opts.theme)
lyr3.find('.ui-widget-content').append(msg);else
lyr3.append(msg);if(msg.jquery||msg.nodeType)
jQuery(msg).show();}
if((msie||opts.forceIframe)&&opts.showOverlay)
lyr1.show();if(opts.fadeIn){var cb=opts.onBlock?opts.onBlock:noOp;var cb1=(opts.showOverlay&&!msg)?cb:noOp;var cb2=msg?cb:noOp;if(opts.showOverlay)
lyr2._fadeIn(opts.fadeIn,cb1);if(msg)
lyr3._fadeIn(opts.fadeIn,cb2);}
else{if(opts.showOverlay)
lyr2.show();if(msg)
lyr3.show();if(opts.onBlock)
opts.onBlock();}
bind(1,el,opts);if(full){pageBlock=lyr3[0];pageBlockEls=jQuery(opts.focusableElements,pageBlock);if(opts.focusInput)
setTimeout(focus,20);}
else
center(lyr3[0],opts.centerX,opts.centerY);if(opts.timeout){var to=setTimeout(function(){if(full)
jQuery.unblockUI(opts);else
jQuery(el).unblock(opts);},opts.timeout);jQuery(el).data('blockUI.timeout',to);}}
function remove(el,opts){var count;var full=(el==window);var jQueryel=jQuery(el);var data=jQueryel.data('blockUI.history');var to=jQueryel.data('blockUI.timeout');if(to){clearTimeout(to);jQueryel.removeData('blockUI.timeout');}
opts=jQuery.extend({},jQuery.blockUI.defaults,opts||{});bind(0,el,opts);if(opts.onUnblock===null){opts.onUnblock=jQueryel.data('blockUI.onUnblock');jQueryel.removeData('blockUI.onUnblock');}
var els;if(full)
els=jQuery('body').children().filter('.blockUI').add('body > .blockUI');else
els=jQueryel.find('>.blockUI');if(opts.cursorReset){if(els.length>1)
els[1].style.cursor=opts.cursorReset;if(els.length>2)
els[2].style.cursor=opts.cursorReset;}
if(full)
pageBlock=pageBlockEls=null;if(opts.fadeOut){count=els.length;els.stop().fadeOut(opts.fadeOut,function(){if(--count===0)
reset(els,data,opts,el);});}
else
reset(els,data,opts,el);}
function reset(els,data,opts,el){var jQueryel=jQuery(el);if(jQueryel.data('blockUI.isBlocked'))
return;els.each(function(i,o){if(this.parentNode)
this.parentNode.removeChild(this);});if(data&&data.el){data.el.style.display=data.display;data.el.style.position=data.position;if(data.parent)
data.parent.appendChild(data.el);jQueryel.removeData('blockUI.history');}
if(jQueryel.data('blockUI.static')){jQueryel.css('position','static');}
if(typeof opts.onUnblock=='function')
opts.onUnblock(el,opts);var body=jQuery(document.body),w=body.width(),cssW=body[0].style.width;body.width(w-1).width(w);body[0].style.width=cssW;}
function bind(b,el,opts){var full=el==window,jQueryel=jQuery(el);if(!b&&(full&&!pageBlock||!full&&!jQueryel.data('blockUI.isBlocked')))
return;jQueryel.data('blockUI.isBlocked',b);if(!full||!opts.bindEvents||(b&&!opts.showOverlay))
return;var events='mousedown mouseup keydown keypress keyup touchstart touchend touchmove';if(b)
jQuery(document).bind(events,opts,handler);else
jQuery(document).unbind(events,handler);}
function handler(e){if(e.type==='keydown'&&e.keyCode&&e.keyCode==9){if(pageBlock&&e.data.constrainTabKey){var els=pageBlockEls;var fwd=!e.shiftKey&&e.target===els[els.length-1];var back=e.shiftKey&&e.target===els[0];if(fwd||back){setTimeout(function(){focus(back);},10);return false;}}}
var opts=e.data;var target=jQuery(e.target);if(target.hasClass('blockOverlay')&&opts.onOverlayClick)
opts.onOverlayClick();if(target.parents('div.'+opts.blockMsgClass).length>0)
return true;return target.parents().children().filter('div.blockUI').length===0;}
function focus(back){if(!pageBlockEls)
return;var e=pageBlockEls[back===true?pageBlockEls.length-1:0];if(e)
e.focus();}
function center(el,x,y){var p=el.parentNode,s=el.style;var l=((p.offsetWidth-el.offsetWidth)/2)-sz(p,'borderLeftWidth');var t=((p.offsetHeight-el.offsetHeight)/2)-sz(p,'borderTopWidth');if(x)
s.left=l>0?(l+'px'):'0';if(y)
s.top=t>0?(t+'px'):'0';}
function sz(el,p){return parseInt(jQuery.css(el,p),10)||0;}}
if(typeof define==='function'&&define.amd&&define.amd.jQuery){define(['jquery'],setup);}else{setup(jQuery);}})();